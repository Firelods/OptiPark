#!/bin/sh\n\n# Script d'initialisation Redis - Filtre les commentaires et gÃ¨re les lignes de continuation\n# This script tolerates CRLF (Windows) line endings and will normalize /scripts/init_parking.redis\n\necho "ðŸ”„ Initialisation de Redis avec le script init_parking.redis..."\n\n# Ensure the init file uses LF line endings (fix Windows CRLF issues)\nif [ -f /scripts/init_parking.redis ]; then\n  sed -i 's/\r$//' /scripts/init_parking.redis || true\nfi\n\n# Attendre que Redis soit prÃªt\nuntil redis-cli -h redis ping > /dev/null 2>&1; do\n  echo "â³ Attente de Redis..."\n  sleep 1\ndone\n\necho "âœ… Redis est prÃªt, exÃ©cution du script d'initialisation..."\n\n# Traiter le fichier :\n# 1. Supprimer les commentaires (lignes commenÃ§ant par #)\n# 2. Joindre les lignes avec backslash (continuation)\n# 3. Supprimer les lignes vides\n# 4. ExÃ©cuter chaque commande dans Redis\n\n# CrÃ©er un fichier temporaire sans commentaires et avec lignes jointes\nsed 's/#.*//' /scripts/init_parking.redis | \\n  sed ':a;/\\$/{N;s/\\\n/ /;ta}' | \\n  grep -v '^[[:space:]]*$' > /tmp/redis_commands.txt\n\n# ExÃ©cuter ligne par ligne\nwhile IFS= read -r line; do\n  echo "$line" | redis-cli -h redis > /dev/null\n  if [ $? -ne 0 ]; then\n    echo "âŒ Erreur lors de l'exÃ©cution de: $line"\n  fi\ndone < /tmp/redis_commands.txt\n\n# Nettoyer\nrm /tmp/redis_commands.txt\n\necho "âœ… Script d'initialisation exÃ©cutÃ© avec succÃ¨s !"\n\n# VÃ©rifier le nombre de clÃ©s crÃ©Ã©es\nKEYS_COUNT=$(redis-cli -h redis DBSIZE)\necho "ðŸ“Š $KEYS_COUNT"\n\n# VÃ©rifier quelques clÃ©s\necho "ðŸ” Exemples de clÃ©s crÃ©Ã©es:"\nredis-cli -h redis KEYS "spot:A-*" | head -5\n